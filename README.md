# Viral Moments

Автоматизированная система для создания и публикации вирусного контента на основе новостей из различных источников. Проект позволяет автоматически собирать новости, генерировать на их основе короткие видеоролики и публиковать их в социальных сетях.

## Описание проекта

Viral Moments - это система, которая:
1. Собирает актуальные новости из различных источников (TechCrunch, ArXiv и др.)
2. Генерирует текстовый контент на основе собранных новостей с помощью GPT
3. Преобразует текст в речь с использованием различных сервисов (Google Speech, ElevenLabs)
4. Создает изображения для видео с помощью генеративных моделей
5. Компонует видеоролик с изображениями, субтитрами и звуком
6. Публикует готовый контент в социальных сетях (YouTube и др.)
7. Отправляет уведомления в Telegram

## Структура проекта

### Основные директории

- **configs/** - Конфигурационные файлы для различных компонентов системы
  - **video/** - Конфигурации для создания видео из разных источников (например, TechCrunch)
  - **config.py** - Основной файл конфигурации с переменными окружения

- **content_generators/** - Модули для генерации текстового контента
  - **base.py** - Базовый генератор контента с использованием OpenAI API
  - **prompts.py** - Генератор промптов для создания изображений
  - **arxiv.py** - Специализированный генератор контента для научных статей

- **data_connectors/** - Модули для получения данных из различных источников
  - **techcrunch.py** - Коннектор для получения новостей с TechCrunch
  - **arxiv.py** - Коннектор для получения научных статей с ArXiv

- **images_generators/** - Модули для генерации изображений
  - **flux_cinestill_replicate.py** - Генератор изображений с использованием Replicate API
  - **flux_replicate.py** - Альтернативный генератор с Replicate
  - **mflux_local.py** - Локальный генератор изображений

- **video_generators/** - Модули для создания и компоновки видео
  - **create_video.py** - Создание видео из изображений
  - **compose_video.py** - Компоновка видео с аудио и субтитрами

- **voice_generators/** - Модули для преобразования текста в речь
  - **google_speech.py** - Генератор речи с использованием Google Text-to-Speech
  - **elevenlabs.py** - Генератор речи с использованием ElevenLabs
  - **kokoro_replicate.py** - Генератор речи с использованием Replicate

- **social_publicators/** - Модули для публикации контента в социальных сетях
  - **youtube.py** - Публикатор для YouTube

- **content_update_server/** - Сервер для автоматического обновления контента
  - **base.py** - Основной модуль сервера с планировщиком задач

- **flows/** - Рабочие процессы для создания контента
  - **base.py** - Базовый рабочий процесс для создания видео

- **utils/** - Вспомогательные утилиты
  - **count_images.py** - Утилита для расчета количества кадров
  - **cleanup.py** - Утилита для очистки временных файлов

- **data/** - Директория для хранения данных
  - **images/** - Сгенерированные изображения
  - **storages/** - Хранилище для отслеживания обработанных постов
  - **bg_music/** - Фоновая музыка для видео
  - **fonts/** - Шрифты для субтитров

### Основные файлы

- **start_poster_server.py** - Основной файл для запуска сервера автоматической публикации
- **test_flow.py** - Тестовый скрипт для проверки рабочего процесса
- **test_poster_flow.py** - Тестовый скрипт для проверки процесса публикации
- **.env** - Файл с переменными окружения
- **requirements.txt** - Список зависимостей проекта
- **techcrunch_credentials.json** - Учетные данные для доступа к YouTube API
- **techcrunch_token.json** - Токен для доступа к YouTube API

## Требования

Для работы проекта необходимы следующие компоненты:

1. Python 3.8+
2. Установленные зависимости из requirements.txt
3. Настроенные API ключи в файле .env:
   - OPENAI_API - ключ для доступа к OpenAI API
   - ELEVEN_LABS_KEY - ключ для доступа к ElevenLabs API
   - REPLICATE_API_TOKEN - токен для доступа к Replicate API
   - TELEGRAM_BOT_TOKEN - токен для Telegram бота
   - PEXELS_API_KEY - ключ для доступа к Pexels API

## Установка и запуск

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/viral-moments.git
cd viral-moments
```

2. Создайте и активируйте виртуальное окружение:
```bash
python -m venv .venv
source .venv/bin/activate  # для Linux/Mac
# или
.venv\Scripts\activate  # для Windows
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

4. Создайте файл .env и заполните его необходимыми API ключами (см. раздел Требования)

5. Создайте необходимые директории для хранения данных:
```bash
mkdir -p data/images/techcrunch
mkdir -p data/storages
mkdir -p data/bg_music
mkdir -p data/fonts
```

6. Добавьте фоновую музыку в директорию data/bg_music/music.wav и шрифт в директорию data/fonts/font.ttf

7. Для запуска сервера автоматической публикации:
```bash
python start_poster_server.py
```

8. Для тестирования рабочего процесса без публикации:
```bash
python test_flow.py
```

## Настройка

Настройка проекта осуществляется через файлы конфигурации в директории configs/. Основные параметры:

- **configs/video/techcrunch.py** - настройки для создания видео на основе новостей TechCrunch
- **configs/config.py** - общие настройки проекта
